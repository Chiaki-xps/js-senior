# token

- cookie 和 session 的方式有很多的缺点：
  - Cookie 会对所有合规的请求附加上 cookie，所以无形中增加了流量（事实上某些请求是不需要的）；
  - Cookie 是明文传递的，所以存在安全性的问题；
  - Cookie 的大小限制是 4KB，对于复杂的需求来说是不够的；
  - 对于浏览器外的其他客户端（比如 iOS、Android），必须手动的设置 cookie 和 session（比较麻烦）；
  - 对于分布式系统和服务器集群中如何可以保证其他系统也可以正确的解析 session？
  - 对于 java 来说解析 session 比较麻烦，实际写 node 的时候，加盐是一样的，所以可以直接解析，还好。
  - 总来来说分布式和集群解析 session 比较麻烦才是原因。
- 所以，在目前的前后端分离的开发过程中，使用 token 来进行身份验证的是最多的情况：
  - token 可以翻译为令牌；
  - 也就是在验证了用户账号和密码正确的情况，给用户颁发一个令牌；
  - 这个令牌作为后续用户访问一些接口或者资源的凭证；
  - 我们可以根据这个凭证来判断用户是否有权限来访问；
- 所以 token 的使用应该分成两个重要的步骤：
  - 生成 token：登录的时候，颁发 token；
  - 验证 token：访问某些资源或者接口时，验证 token；

## 生成 token

+ JWT生成的Token由三部分组成（header 、payload、signature）：
  + header：
    + alg：采用的加密算法，默认是 HMAC SHA256（HS256），采用同一个密钥进行 加密和解密； 
    + typ：JWT，固定值，通常都写成JWT即可； 
    + 会通过base64Url算法进行编码；
  + payload：
    + 携带的数据，
